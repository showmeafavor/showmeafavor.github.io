!function(t,i,n){function e(i,n){this.element=i,this.settings=t.extend({},o,n),this.init()}var s="dialogBox",o={width:null,height:null,autoSize:!0,autoHide:!1,time:3e3,zIndex:99999,hasMask:!1,hasClose:!1,hasBtn:!1,confirmValue:null,confirm:function(){},cancelValue:null,cancel:function(){},effect:"",type:"normal",title:"",content:"",callback:function(){},close:function(){}};e.prototype={init:function(){var t=this,i=this.element;t.render(i),t.setStyle(),t.show(),t.trigger(i)},getIdValue:function(i){var n=t(i),e=n.attr("id");return"undefined"!=typeof e?e:e=""},create:function(i){var n=this,e=(t(i),n.getIdValue(i)),s=n.settings.title,o=n.settings.hasBtn,a=n.settings.hasMask,d=n.settings.hasClose,l=n.settings.confirmValue,c=n.settings.cancelValue,g=[];return g[0]=s?d?'<section id="'+e+'" class="dialog-box"><div class="dialog-box-container"><div class="dialog-box-title"><h3>'+s+'</h3><span class="dialog-box-close">×</span></div><div class="dialog-box-content"></div>':'<section id="'+e+'" class="dialog-box"><div class="dialog-box-container"><div class="dialog-box-title"><h3>'+s+'</h3></div><div class="dialog-box-content"></div>':'<section id="'+e+'" class="dialog-box"><div class="dialog-box-container"><div class="dialog-box-content"></div>',g[1]=o?l&&c?'<div class="dialog-btn"><span class="dialog-btn-cancel">'+c+'</span><span class="dialog-btn-confirm">'+l+"</span></div></div></section>":c?'<div class="dialog-btn"><span class="dialog-btn-cancel">'+c+"</span></div></div></section>":l?'<div class="dialog-btn"><span class="dialog-btn-confirm">'+l+"</span></div></div></section>":'<div class="dialog-btn"><span class="dialog-btn-cancel">取消</span><span class="dialog-btn-confirm">确定</span></div></div></section>':"</div></section>",g[2]=a?'<div id="dialog-box-mask"></div>':"",g},render:function(i){var n=this,e=t(i),s=n.create(e),o=n.parseContent();e.replaceWith(s[0]+s[1]),"object"==typeof o?o.appendTo(".dialog-box-content"):t(".dialog-box-content").append(o),t("body").append(s[2])},parseContent:function(){var n=this,e=n.settings.content,s=(n.settings.width,n.settings.height,n.settings.type),o=t("<iframe>"),a="?tmp="+Math.random(),d=/^(https?:\/\/|\/|\.\/|\.\.\/)/;return d.test(e)?(o.attr({src:e+a,frameborder:"no",scrolling:"no",name:"dialog-box-iframe",id:"dialog-box-iframe"}).on("load",function(){var e=t(i.frames["dialog-box-iframe"].document),o=t(i.frames["dialog-box-iframe"].document.body),a=e.outerWidth()-8,d=e.outerHeight()-16,l=t(".dialog-box"),c=t(".dialog-box-content"),g=t(".dialog-box-container");dialogBoxWidth=a+40,dialogBoxHeight=d+130,n.settings.autoSize?(t(this).width(a),t(this).height(d),o.css({margin:"0",padding:"0"}),c.css({width:a+"px",height:d+"px"}),g.css({width:dialogBoxWidth+"px",height:function(){return n.settings.hasBtn?dialogBoxHeight+"px":dialogBoxHeight-54+"px"}}),l.css({width:dialogBoxWidth,height:function(){return n.settings.hasBtn?""===s||"normal"===s?dialogBoxHeight+"px":"error"===s||"correct"===s?(dialogBoxHeight+=4,dialogBoxHeight+"px"):void 0:dialogBoxHeight-50+"px"},"margin-top":function(){return n.settings.hasBtn?""===s||"normal"===s?-Math.round(dialogBoxHeight/2)+"px":"error"===s||"correct"===s?(dialogBoxHeight=dialogBoxHeight,-Math.round(dialogBoxHeight/2)+"px"):void 0:-Math.round((dialogBoxHeight-50)/2)+"px"},"margin-left":-Math.round(dialogBoxWidth/2)+"px"})):(t(this).width(n.settings.width-40),t(this).height(n.settings.height-130))}),o):e instanceof jQuery?e.clone(!0,!0):1===e.nodeType&&"string"===e.nodeName?e.innerHTML:e},show:function(){t(".dialog-box").css({display:"block"}),setTimeout(function(){t(".dialog-box").addClass("show")},50),t("#dialog-box-mask").show()},hide:function(i){var n=t(i),e=t(".dialog-box"),s=t("#dialogBox-box-iframe");e.removeClass("show"),setTimeout(function(){s&&s.attr("src","_blank"),e.replaceWith('<div id="'+n.attr("id")+'"></div/>'),t("#dialog-box-mask").remove()},150)},setStyle:function(){var i=this,e=t(".dialog-box"),s=t(".dialog-box-container"),o=t(".dialog-box-content"),a=t("#dialog-box-mask"),d=i.settings.type,l="effect";switch(e.css({width:function(){return i.settings.width?i.settings.width+"px":i.settings.autoSize?t(this).width():void 0},height:function(){if(i.settings.height){if(""===d||"normal"===d)return i.settings.height+"px";if("error"===d||"correct"===d)return i.settings.height+4+"px"}else if(i.settings.autoSize)return t(this).height()},"margin-top":function(){var n;return""===d||"normal"===d?n=i.settings.autoSize?t(this).height():i.settings.height:("error"===d||"correct"===d)&&(n=i.settings.autoSize?t(this).height():i.settings.height+4),-Math.round(n/2)+"px"},"margin-left":function(){var i=t(this).width();return-Math.round(i/2)+"px"},"z-index":i.settings.zIndex}),s.css({width:function(){return i.settings.width?i.settings.width+"px":void 0},height:function(){return i.settings.height?i.settings.height+"px":void 0}}),o.css({width:function(){return i.settings.width?i.settings.width-40+"px":void 0},height:function(){return i.settings.height?i.settings.height-130+"px":void 0}}),a.css({height:t(n).height()+"px"}),i.settings.type){case"correct":s.addClass("correct");break;case"error":s.addClass("error");break;default:s.addClass("normal")}switch(i.settings.effect){case"newspaper":e.addClass(l+"-newspaper");break;case"fall":e.addClass(l+"-fall");break;case"scaled":e.addClass(l+"-scaled");break;case"flip-horizontal":e.addClass(l+"-flip-horizontal");break;case"flip-vertical":e.addClass(l+"-flip-vertical");break;case"sign":e.addClass(l+"-sign");break;default:e.addClass(l+"-fade")}},trigger:function(i){var e=this,s=t(i);t.isFunction(e.settings.callback)&&e.settings.callback(),t(".dialog-box-close,#dialog-box-mask").on("click",function(t){e.settings.close.call(e),t.stopPropagation()}),t(".dialog-box-close,#dialog-box-mask,.dialog-btn-cancel,.dialog-btn-confirm").on("click",function(t){e.hide(s),t.stopPropagation()}),t(n).keyup(function(t){27===t.keyCode&&e.hide(s)}),e.settings.autoHide&&setTimeout(function(){e.hide(s)},e.settings.time),t.isFunction(e.settings.confirm)&&t(".dialog-btn-confirm").on("click",function(){e.settings.confirm()}),t.isFunction(e.settings.cancel)&&t(".dialog-btn-cancel").on("click",function(){e.settings.cancel()})}},t.fn[s]=function(i){return this.each(function(){t.data(this,"plugin_"+s)||t.data(this,"plugin_"+s,new e(this,i))}),this}}(jQuery,window,document);